# 数组去重

抛开老土的暴力遍历，我们聊点儿高级的。

#### underscore 中的 unique 函数

该版本的 unique 函数不仅实现了数组去重，还支持传入 `iteratee` 函数，对每一项进行处理。

```javascript
function unique(array, isSorted, iteratee) {
    var res = [];
    var seen = [];

    for (var i = 0, len = array.length; i < len; i++) {
        var value = array[i];
        var computed = iteratee ? iteratee(value, i, array) : value;
        // 如果数组是排好序的并且未传入 iteratee 函数
        if (isSorted && !iteratee) {
            // 当前项为第一项或与前一项不相等时，向 res 数组中 push 当前项
            if (!i || seen !== value) {
                res.push(value)
            }
            seen = value;
        }
        else if (iteratee) {
            if (seen.indexOf(computed) === -1) {
                seen.push(computed);
                res.push(value);
            }
        }
        else if (res.indexOf(value) === -1) {
            res.push(value);
        }        
    }
    return res;
}
```

#### filter 版

```javascript
function uniqueFilter (arr) {
    return arr.filter((item, index, array) => {
        return array.indexOf(item) === index
    })
}
```

#### ES6 版

```javascript
function uniqueSet(arr) {
    return Array.from(new Set(arr))
}
```

#### 补充

`JavaScript` 原生的排序方法 `sort()` 。当调用该方法并且不传入比较函数时，`sort` 内部会将数组项转换为字符串，然后按照其在 `UTF-16` 中的出现次序进行排序。（但是对于对象或者数组，sort 并没有将其转换成字符串再比较，这个我也不知道是为什么，先作为一个问题留在这里吧）

#### 结论

underscore 版可以在数组遍历过程中对每一项进行操作。另外两版则更简短。`Array.from()`目前在浏览器中还不支持。